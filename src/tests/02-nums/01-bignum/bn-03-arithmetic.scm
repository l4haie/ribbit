;; Bignum's arithmetic operators: +, *, -, and / 


;; addition
;; TODO more tests for carries and arguments parity 
(test-display "bignum's addition:")
(test-display (+ 0 -5093029553211653449872027)) ;; bn/fx
(test-display (+ 5596023648066549911988183 1)) ;; bn/fx
(test-display (+ 80676928238280689964004824354037014163149658979409 24323789690706977942236250822168895738379862300159))
(test-display (+ 37764716512289357860158816175578297352334460428151 -26272037343146531977774160319906655418763979293344))
(test-display (+ -19521541341899485444734567383162499341913181480927 77710386387734317720754565453220777092120190516609))
(test-display (+ -62804909263601975988281613323166636528619326686336 -62735676303544776280350450777235547105859548702790))
;; variadics
;; (test-display (+ 3282306647093844609550582 4379 -2317253594081284811174502 8410270193852110555964462))
;;  => 9375323246864670354344921
;; (test-display (+)) ;; (+) => 0
;;  => 0
;; (test-display (+ 31415926535897932384626433832795028841971693993751)) ;; (+ a) = a
;;  => 31415926535897932384626433832795028841971693993751

;; multiplication
;; TODO add more specialized tests for Karatsuba
(test-display "bignum's multiplication:")
(test-display (* 204208320856611906254543372131 535958450687724602901618766795)) ;; (* pos pos) => pos
(test-display (* 240616342522577195429162991930 -645537799140373404328752628889)) ;; (* pos neg) => neg
(test-display (* -639958794757291746426357455254 790914513571113694109119393251)) ;; (* neg pos) => neg
(test-display (* -910760208252026187985318877058 -429725916778131496990090192116)) ;; (* neg neg) => pos
(test-display (* 359614589019389713111790429782856475032031986915140287080859 904)) ;; (* bn fx) => bn
(test-display (* 947647772622414254854540332157185306142288137585043063321751 -1)) ;; (* bn -fx) => -bn
(test-display (* 1 -4949450114654062843366393790039769265672146385306736096571209)) ;; (* fx -bn) => -bn
(test-display (* -1807 -8880078692560290228472104031721186082041900042296617119637792)) ;; (* -fx -bn) => bn
(test-display (* 31290 29547)) ;; (* fx fx) => bn
(test-display (* 76446248246857926039535277348030480290058760758251047470916439613626760449256274 0)) ;; (* bignum 0) => 0
;; variadics
;; (test-display (* 2948954930381964428810975 -6659334461284756482337867 -844 8316527120190914564856692))
;;  => 137842587717676256768944713858731884130288153993965770051856903705012639735600
;; (test-display (*)) ;; => 1
;;  => 1
;; (test-display (* 31415926535897932384626433832795028841971693993751)) ;; (* a) = a
;;  => 31415926535897932384626433832795028841971693993751

;; substraction
(test-display "bignum's substraction:")
(test-display (- 4328 8983569485562099219222184)) ;; bn/fx
(test-display (- 2332390739414333454776241 -6863)) ;; bn/fx
(test-display (- 8143562401451718062464362679456127531813 407833033625423278394497538243720583531147711992606381334677))
(test-display (- 6879695970309833913077109870408591337464 -144282277263465947047458784778720192771528073176790770715721))
(test-display (- 344473060570073349243693113835049316312840425121925651798069 -4113528013147013047816437885185290928545))
(test-display (- -201165839341965621349143415956258658655705526904965209858033 -8507224264829397285847831630577775606888))

;; unary substraction
;; (test-display "bignum's unary substraction:")
;; (test-display (- 97173727847684726860849003377024242916513005005168323364350389517029893922334517))
;;  => -97173727847684726860849003377024242916513005005168323364350389517029893922334517
;; (test-display (- -22013812806965011784408745196012122859937162313017114448464090389064495444006198))
;;  => 22013812806965011784408745196012122859937162313017114448464090389064495444006198

;; division
;; `/` is mapped to `quotient` when flonums are not imported so not much to do here...
(test-display "bignum's division:")
(test-display (/ 5820974944592307816406286208998628034825 34211706798214808651))

;; ;; unary division
;; (test-display "bignum's unary division:")
;; (test-display (/ 31415926535897932384626433832795028841971693993751)) ;; (/ a) => (quotient 1 a)
;;  => 0


;;;run: -l nums/nums -f+ nums/bignum -l r4rs -f+ scheme-bignum
;;;expected:
;;;bignum's addition:
;;;-5093029553211653449872027
;;;5596023648066549911988184
;;;105000717928987667906241075176205909901529521279568
;;;11492679169142825882384655855671641933570481134807
;;;58188845045834832276019998070058277750207009035682
;;;-125540585567146752268632064100402183634478875389126
;;;bignum's multiplication:
;;;109447175263851475898050147902487213179665409408592991190145
;;;-155326944189230725681962101155865142950816677893856191865770
;;;-506152698861019586175178635212961921714585921347356862090754
;;;391377265456143916734134781243890615978829116741876604874728
;;;325091588473528300653058548523702253428956916171286819521096536
;;;-947647772622414254854540332157185306142288137585043063321751
;;;-4949450114654062843366393790039769265672146385306736096571209
;;;16046302197456444442849091985320183250249713376429987135185490144
;;;924525630
;;;0
;;;bignum's substraction:
;;;-8983569485562099219217856
;;;2332390739414333454783104
;;;-407833033625423278386353975842268865468683349313150253802864
;;;144282277263465947054338480749030026684605183047199362053185
;;;344473060570073349247806641848196329360656863007110942726614
;;;-201165839341965621340636191691429261369857695274387434251145
;;;bignum's division:
;;;170145704186148656447
